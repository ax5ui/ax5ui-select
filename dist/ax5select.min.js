"use strict";!function(e,t){var i=ax5.util,n=function(){var e,n=this;t&&t.call(this),this.queue=[],this.config={clickEventName:"click",theme:"default",title:"",animateTime:250,lang:{emptyOfSelected:"",multipleLabel:'"{{label}}"외 {{length}}건'},columnKeys:{optionValue:"value",optionText:"text",optionSelected:"selected"},displayMargin:14},this.activeSelectOptionGroup=null,this.activeSelectQueueIndex=-1,this.openTimer=null,this.closeTimer=null,e=this.config;var s=function(e,t){return e&&e.onStateChanged?e.onStateChanged.call(t,t):this.onStateChanged&&this.onStateChanged.call(t,t),e=null,t=null,!0},l=function(e){return'\n                <div class="ax5-ui-select-option-group {{theme}} {{size}}" data-ax5-select-option-group="{{id}}">\n                    <div class="ax-select-body">\n                        <div class="ax-select-option-group-content" data-select-els="content">\n                        {{#options}}\n                            <div class="ax-select-option-item" data-option-index="{{@i}}" data-option-value="{{'+e.optionValue+'}}" {{#'+e.optionSelected+'}}data-option-selected="true"{{/'+e.optionSelected+'}}>\n                                <div class="ax-select-option-item-holder">\n                                    {{#multiple}}\n                                    <span class="ax-select-option-item-cell ax-select-option-item-checkbox">\n                                        <span class="item-checkbox-wrap useCheckBox" data-option-checkbox-index="{{@i}}"></span>\n                                    </span>\n                                    {{/multiple}}\n                                    {{^multiple}}\n                                    \n                                    {{/multiple}}\n                                    <span class="ax-select-option-item-cell ax-select-option-item-label">{{'+e.optionText+'}}</span>\n                                </div>\n                            </div>\n                        {{/options}}\n                        </div>\n                    </div>\n                    <div class="ax-select-arrow"></div> \n                </div>\n                '},o=function(){return'\n                <a {{^tabIndex}}href="#ax5select-{{id}}" {{/tabIndex}}{{#tabIndex}}tabindex="{{tabIndex}}" {{/tabIndex}}class="form-control {{formSize}} ax5-ui-select-display {{theme}}" \n                data-ax5-select-display="{{id}}">\n                    <div class="ax5-ui-select-display-table" data-select-els="display-table">\n                        <div data-ax5-select-display="label">{{label}}</div>\n                        <div data-ax5-select-display="addon" data-ax5-select-opened="false">\n                            {{#icons}}\n                            <span class="addon-icon-closed">{{clesed}}</span>\n                            <span class="addon-icon-opened">{{opened}}</span>\n                            {{/icons}}\n                            {{^icons}}\n                            <span class="addon-icon-closed"><span class="addon-icon-arrow"></span></span>\n                            <span class="addon-icon-opened"><span class="addon-icon-arrow"></span></span>\n                            {{/icons}}\n                        </div>\n                    </div>\n                </a>\n                '},a=function(){for(var t,i=this.queue.length;i--;)this.queue[i].$display&&(t=this.queue[i].select.outerWidth(),"block"!=this.queue[i].select.css("display")&&(t+=e.displayMargin),this.queue[i].$display.css({"min-width":t}));return i=null,t=null,this},c=function(e){if(!this.activeSelectOptionGroup)return this;var t=this.queue[this.activeSelectQueueIndex],i={},n={};e&&jQuery(document.body).append(this.activeSelectOptionGroup),i=t.$target.offset(),n={width:t.$target.outerWidth(),height:t.$target.outerHeight()},t.direction&&""!==t.direction&&"auto"!==t.direction||(t.direction="top"),e&&this.activeSelectOptionGroup.addClass("direction-"+t.direction),this.activeSelectOptionGroup.css(function(){return"top"==t.direction?{left:i.left,top:i.top+n.height+1,width:n.width}:"bottom"==t.direction?{left:i.left,top:i.top-this.activeSelectOptionGroup.outerHeight()-1,width:n.width}:void 0}.call(this))},u=function(e,t){if(!this.activeSelectOptionGroup)return this;var n=this.queue[this.activeSelectQueueIndex],s="display";return(t=i.findParentNode(e.target,function(e){return e.getAttribute("data-option-value")?(s="optionItem",!0):n.$target.get(0)==e?(s="display",!0):void 0}))?("display"!=s&&(this.val(n.id,{index:t.getAttribute("data-option-index")}),n.multiple||this.close()),this):(this.close(),this)},d=function(e){e.keyCode==ax5.info.eventKeys.ESC&&this.close()},r=function(t){var n=this.queue[t],s=[];return i.isArray(n.selected)&&n.selected.length>0?n.selected.forEach(function(t){t.selected&&s.push(t[e.columnKeys.optionText])}):!n.multiple&&n.options[0]?s[0]=n.options[0][e.columnKeys.optionText]:s[0]="",function(){if(n.multiple&&s.length>1){var t={label:s[0],length:s.length-1};return ax5.mustache.render(e.lang.multipleLabel,t)}return s[0]}()},p=function(){var e={click:function(e,t){n.activeSelectQueueIndex==e?n.close():n.open(e),i.stopEvent(t)},keyUp:function(t,i){i.which==ax5.info.eventKeys.SPACE?e.click.call(this,t,i):i.which==ax5.info.eventKeys.DOWN}};return function(t){var i=this.queue[t],n={};return i.$display?(i.options=h.call(this,t,i.options),i.$display.find('[data-ax5-select-display="label"]').html(r.call(this,t)),a.call(this),i.$display.unbind("click.ax5select").bind("click.ax5select",e.click.bind(this,t)).unbind("keyup.ax5select").bind("keyup.ax5select",e.keyUp.bind(this,t))):(i.options=h.call(this,t,i.options),n.id=i.id,n.tabIndex=i.tabIndex,n.label=r.call(this,t),n.formSize=function(){return i.select.hasClass("input-lg")?"input-lg":i.select.hasClass("input-sm")?"input-sm":void 0}(),i.$display=jQuery(ax5.mustache.render(o.call(this,i,t),n)),i.$target.append(i.$display),a.call(this),i.$display.unbind("click.ax5select").bind("click.ax5select",e.click.bind(this,t)).unbind("keyup.ax5select").bind("keyup.ax5select",e.keyUp.bind(this,t))),n=null,i=null,t=null,this}}(),h=function(){var t=function(e,t){t?this.queue[e].multiple?this.queue[e].selected.push(jQuery.extend({},t)):this.queue[e].selected[0]=jQuery.extend({},t):this.queue[e].selected=[]};return function(s,l){var o,a,c,u=this.queue[s];return t.call(this,s,!1),l?(u.options=l,o=[],u.options.forEach(function(i,l){i["@index"]=l,o.push('<option value="'+i[e.columnKeys.optionValue]+'" '+(i[e.columnKeys.optionSelected]?' selected="selected"':"")+">"+i[e.columnKeys.optionText]+"</option>"),i[e.columnKeys.optionSelected]&&t.call(n,s,i)}),u.select.html(o.join(""))):(a=i.toArray(u.select.get(0).options),c=[],a.forEach(function(i,l){var o={};o[e.columnKeys.optionValue]=i.value,o[e.columnKeys.optionText]=i.text,o[e.columnKeys.optionSelected]=i.selected,o["@index"]=l,i.selected&&t.call(n,s,o),c.push(o),o=null}),u.options=c),u.multiple||0!=u.selected.length||(u.selected=jQuery.extend({},u.options[0])),o=null,a=null,c=null,u.options}}();this.init=function(){this.onStateChanged=e.onStateChanged,jQuery(window).bind("resize.ax5select-display",function(){a.call(this)}.bind(this))},this.bind=function(t){var n,s={};return t=jQuery.extend(s,e,t),t.target?(t.$target=jQuery(t.target),t.id||(t.id=t.$target.data("ax5-select")),t.id||(t.id="ax5-select-"+ax5.getGuid(),t.$target.data("ax5-select",t.id)),t.select=t.$target.find("select"),t.tabIndex=t.select.attr("tabindex"),t.select.attr("tabindex","-1"),t.multiple=t.select.attr("multiple"),t.size=t.select.attr("data-size"),t.options&&(t.options=JSON.parse(JSON.stringify(t.options))),function(e){i.isObject(e)&&!e.error&&(t=jQuery.extend(!0,t,e))}(i.parseJson(t.$target.attr("data-ax5select"),!0)),n=i.search(this.queue,function(){return this.id==t.id}),-1===n?(this.queue.push(t),p.call(this,this.queue.length-1)):(this.queue[n]=jQuery.extend({},this.queue[n],t),p.call(this,n)),s=null,n=null,this):(console.log(ax5.info.getError("ax5select","401","bind")),this)},this.open=function(){return function(t,n){if(t instanceof jQuery||i.isElement(t)){var o=jQuery(t).data("ax5-select");if(t=ax5.util.search(this.queue,function(){return this.id==o}),-1==t)return console.log(ax5.info.getError("ax5select","402","open")),this}var a,r,p=this.queue[t],h={};return this.openTimer&&clearTimeout(this.openTimer),this.activeSelectOptionGroup?this.activeSelectQueueIndex==t?this:n>2?this:(this.close(),this.openTimer=setTimeout(function(){this.open(t,(n||0)+1)}.bind(this),e.animateTime),this):(h.id=p.id,h.theme=p.theme,h.size="ax5-ui-select-option-group-"+p.size,h.multiple=p.multiple,h.options=p.options,p.$display.attr("data-select-option-group-opened","true"),this.activeSelectOptionGroup=jQuery(ax5.mustache.render(l.call(this,e.columnKeys),h)),this.activeSelectQueueIndex=t,c.call(this,"append"),jQuery(window).bind("resize.ax5select",function(){c.call(this)}.bind(this)),p.selected&&p.selected.length>0&&(r=this.activeSelectOptionGroup.find('[data-option-index="'+p.selected[0]["@i"]+'"]'),r.get(0)&&(a=r.position().top-this.activeSelectOptionGroup.height()/3,this.activeSelectOptionGroup.find('[data-select-els="content"]').stop().animate({scrollTop:a},e.animateTime,"swing",function(){}))),jQuery(window).bind("keyup.ax5select",function(e){e=e||window.event,d.call(this,e),i.stopEvent(e)}.bind(this)),jQuery(window).bind("click.ax5select",function(e){e=e||window.event,u.call(this,e),i.stopEvent(e)}.bind(this)),s.call(this,p,{self:this,state:"open",boundObject:p}),h=null,a=null,r=null,this)}}(),this.update=function(e){return this.bind(e),this},this.val=function(){var e={index:function(e,t){this.queue[e].multiple||this.queue[e].options.forEach(function(e){e.selected=!1});var s=function(e,t){return e.multiple?!t:!0};i.isArray(t.index)?t.index.forEach(function(t){n.queue[e].options[t].selected=s(n.queue[e],n.queue[e].options[t].selected),n.activeSelectOptionGroup.find('[data-option-index="'+t+'"]').attr("data-option-selected",n.queue[e].options[t].selected.toString())}):(n.queue[e].options[t.index].selected=s(n.queue[e],n.queue[e].options[t.index].selected),n.activeSelectOptionGroup.find('[data-option-index="'+t.index+'"]').attr("data-option-selected",n.queue[e].options[t.index].selected.toString())),h.call(this,e,this.queue[e].options),this.queue[e].$display.find('[data-ax5-select-display="label"]').html(r.call(this,e)),c.call(this)},text:function(e,t){},arr:function(e,t){},value:function(e,t){console.log(opts,t)}};return function(t,n){if(i.isString(t)||(t=jQuery(t).data("ax5-select")),!i.isString(t))return void console.log(ax5.info.getError("ax5select","402","val"));var s=ax5.util.search(this.queue,function(){return this.id==t});if("undefined"==typeof n)return this.queue[s].selected;if(i.isArray(n))e.arr.call(this,s,n);else if(i.isString(n)||i.isNumber(n))e.value.call(this,s,n);else for(var l in e)if(n[l]){e[l].call(this,s,n);break}return t=null,this}}(),this.close=function(t){return this.closeTimer&&clearTimeout(this.closeTimer),this.activeSelectOptionGroup?(t=this.queue[this.activeSelectQueueIndex],t.$display.removeAttr("data-select-option-group-opened"),this.activeSelectOptionGroup.addClass("destroy"),jQuery(window).unbind("resize.ax5select"),jQuery(window).unbind("click.ax5select"),jQuery(window).unbind("keyup.ax5select"),this.closeTimer=setTimeout(function(){this.activeSelectOptionGroup&&this.activeSelectOptionGroup.remove(),this.activeSelectOptionGroup=null,this.activeSelectQueueIndex=-1,s.call(this,t,{self:this,state:"close"})}.bind(this),e.animateTime),this):this},this.main=function(){arguments&&i.isObject(arguments[0])?this.setConfig(arguments[0]):this.init()}.apply(this,arguments)};e.select=function(){return i.isFunction(t)&&(n.prototype=new t),n}()}(ax5.ui,ax5.ui.root),ax5.ui.select_instance=new ax5.ui.select,jQuery.fn.ax5select=function(){return function(e){return"undefined"==typeof e&&(e={}),jQuery.each(this,function(){var t={target:this};e=jQuery.extend({},e,t),ax5.ui.select_instance.bind(e)}),this}}();